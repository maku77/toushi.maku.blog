{{- $words := .Site.Data.words.definitions }}

<style>
  .local-wordCount {
    text-align: right;
  }
  .local-ref {
  }
  .local-synonyms {
    color: #666;
    font-weight: normal;
    margin-left: 3em;
  }
  .local-synonyms::before {
    content: 'ï¼';
    margin-right: 0.2em;
  }
  .local-copyDesc {
    {{- if .Site.IsServer }}
      color: gray;
      background: #eee;
      border-radius: 0.3em;
    {{- end }}
  }
  dt {
    color: #dd3300;
    font-weight: bolder;
  }
  dt > .en, dt > .jp {
    color: gray;
    font-weight: normal;
    font-style: italic;
  }
  dt > .index {
    color: lightgray;
    font-weight: normal;
    font-size: smaller;
  }
  dt > .tag {
    color: gray;
    font-size: smaller;
    font-weight: normal;
    vertical-align: middle;
    border: solid 1px lightgray;
    border-radius: 1em;
    padding: 0.1em 0.7em;
    background: #efefef;
  }
  dd {
    color: #333;
    margin-top: 0.3em;
    font-weight: normal;
  }
</style>

  <div class="local-wordCount">
    ç™»éŒ²æ•°: {{ len $words }}ï¼ˆéšæ™‚è¿½åŠ ä¸­ï¼‰
  </div>

  <dl>
    {{- range $index, $elem := $words }}
      {{- /* desc ã‚‚ copy ã‚‚å®šç¾©ã•ã‚Œã¦ã„ãªã„å˜èªãŒè¦‹ã¤ã‹ã£ãŸã‚‰ã‚¨ãƒ©ãƒ¼è¡¨ç¤º */}}
      {{- if and (not (isset . "desc")) (not (isset . "copy")) }}
        {{- errorf "Word \"%s (%s)\" has neither `.desc` nor `.copy`." .label .id  }}
      {{- end }}

      {{- /* copy ãŒå®šç¾©ã•ã‚Œã¦ã„ãŸã‚‰ã‚ªãƒªã‚¸ãƒŠãƒ«ã®å˜èªå®šç¾©ã® descã€tagsã€antonymsã€related ã‚’æ¡ç”¨ */}}
      {{- $copiedDesc := "" }}
      {{- $tags := .tags }}
      {{- $antonyms := .antonyms }}
      {{- $related := .related }}

      {{- with .copy }}
        {{- $copiedWord := index (first 1 (where $words "id" "==" .)) 0 }}
        {{- if $copiedWord }}
          {{- $copiedDesc = $copiedWord.desc }}
          {{- $tags = $copiedWord.tags }}
          {{- $antonyms = $copiedWord.antonyms }}
          {{- $related = $copiedWord.related }}

          {{- if $elem.desc }}
            {{- errorf "\"%s (%s)\" ã«ã¯ `.copy` ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã®ã« `.desc` ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚" $elem.label $elem.id }}
          {{- end }}
          {{- if $elem.tags }}
            {{- errorf "\"%s (%s)\" ã«ã¯ `.copy` ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã®ã« `.tags` ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚" $elem.label $elem.id }}
          {{- end }}
          {{- if $elem.antonyms }}
            {{- errorf "\"%s (%s)\" ã«ã¯ `.copy` ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã®ã« `.antonyms` ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚" $elem.label $elem.id }}
          {{- end }}
          {{- if $elem.related }}
            {{- errorf "\"%s (%s)\" ã«ã¯ `.copy` ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã®ã« `.related` ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚" $elem.label $elem.id }}
          {{- end }}
        {{- else }}
          {{- errorf "\"%s (%s)\" ã® `.copy` ã«è¨­å®šã•ã‚ŒãŸ `%s` ã¨ã„ã† ID ã¯å®šç¾©ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚" $elem.label $elem.id . }}
        {{- end }}
      {{- end }}

      <dt>
        {{- with .id }}<a id="{{ . }}"></a>{{ end }}
        <span class="index">{{ add $index 1 }}. </span>
        {{ .label }}
        {{- with .yomi }}ï¼ˆ{{ . }}ï¼‰{{ end }}
        {{- with .english }}<span class="en">{{ . }}</span>{{ end }}
        {{- with .japanese }}<span class="jp">{{ . }}</span>{{ end }}
        {{- range $tags }}<span class="tag">{{ . }}</span>{{ end }}
        {{- with .synonyms }}
          <div class="local-synonyms">{{ . | markdownify }}</div>
        {{- end }}
      </dt>
      <dd>
        {{- with .desc }}{{ . | markdownify }}{{ end }}
        {{- with $copiedDesc }}
          <div class="local-copyDesc">{{ . | markdownify }}</div>
        {{- end }}

        {{- with $antonyms }}
          <div class="local-ref">ğŸ“•å¯¾ç¾©èª: {{ . | markdownify }}</div>
        {{- end }}

        {{- with $related }}
          <div class="local-ref">ğŸ“—é–¢é€£ç”¨èª: {{ . | markdownify }}</div>
        {{- end }}

        {{- range .pages }}
          <div class="local-ref">ğŸ“˜å‚è€ƒãƒšãƒ¼ã‚¸: <a href="{{ .pid }}">{{ .title }}</a></div>
        {{- end }}

        {{- with .more }}
          <div class="local-ref"><a href="{{ . | relURL }}">ğŸ“˜ã‚‚ã£ã¨è©³ã—ã</a></div>
        {{- end }}
      </dt>
    {{- end }}
  </dl>

